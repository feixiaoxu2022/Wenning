<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wenning</title>
    <link rel="stylesheet" href="/static/css/style.css?v=20251201-3">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <h1 class="title">Wenning</h1>
            <div class="model-selector">
                <label for="model-select">Model</label>
                <select id="model-select">
                    <!-- åŠ¨æ€åŠ è½½ -->
                </select>
                <button id="theme-toggle" class="theme-toggle" title="Toggle Theme">ðŸŒ™</button>
                <div class="account" id="account">
                    <button id="account-btn" class="account-btn" title="Account">ðŸ‘¤</button>
                    <div id="account-menu" class="account-menu" style="display:none;">
                        <div class="account-row" id="account-username">Not signed in</div>
                        <button id="logout-btn" class="account-logout">Logout</button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="main-container center-mode">
        <!-- Conversations Sidebar (Left) -->
        <div class="conversations-sidebar" id="conversations-sidebar">
            <div class="conversations-header">
                <button id="new-conversation-btn" class="new-conversation-entry" title="New Chat" aria-label="New Chat">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
                        <rect x="3" y="3" width="18" height="18" rx="3" stroke="currentColor" stroke-width="1.8"/>
                        <path d="M14.8 7.6l1.6 1.6M10 16l-2.7.6.6-2.7 6.2-6.2 2.1 2.1L10 16z" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                    </svg>
                    <span class="new-conversation-text">New Chat</span>
                </button>
            </div>
            <!-- Workspace Panel -->
            <div class="workspace-panel">
                <div class="workspace-header" id="workspace-header">Workspace</div>
                <div class="workspace-list" id="workspace-list">
                    <div class="workspace-empty">No files yet. Generated files will appear here.</div>
                </div>
            </div>

            <!-- History quick entry -->
            <div class="sidebar-footer">
                <button id="history-toggle" class="history-toggle">History</button>
            </div>

            <!-- History overlay -->
            <div class="history-overlay" id="history-overlay">
                <div class="history-header">
                    <div>History</div>
                    <button id="history-close" class="history-close">âœ•</button>
                </div>
                <div class="conversations-list" id="conversations-list"></div>
            </div>
        </div>

        <!-- Splitter: Left <-> Middle -->
        <div class="v-splitter" id="splitter-left" title="æ‹–æ‹½è°ƒæ•´å®½åº¦"></div>

        <!-- Chat Panel (Middle) -->
        <div class="chat-panel" id="chat-panel">
            <!-- Messages Area -->
            <div class="chat-messages" id="chat-messages">
                <!-- æ¶ˆæ¯å°†åŠ¨æ€æ·»åŠ åˆ°è¿™é‡Œ -->
            </div>

            <!-- Input Area -->
            <div class="chat-input-container">
                <!-- Input and Send Button -->
                <div class="input-row">
                    <div class="chat-input-box">
                        <textarea
                            id="chat-input"
                            class="chat-input has-addon"
                            placeholder="Type your message..."
                            rows="3"
                        ></textarea>
                        <div class="add-file-wrapper inside">
                            <input type="file" id="attach-input" multiple style="display:none" />
                            <button id="attach-btn" class="add-btn inside" type="button" aria-label="Attach Files">
                                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 5V19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                    <path d="M5 12H19" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                            </button>
                            <span class="tooltip" role="tooltip">Attach Files</span>
                        </div>
                        <div class="attachments-strip" id="attachments-strip"></div>
                    </div>
                    <button id="send-btn" class="send-btn">Send</button>
                    <button id="stop-btn" class="stop-btn" style="display:none" title="Stop Current Run">Stop</button>
                </div>
                <!-- Context Indicator -->
                <div class="context-indicator-bottom">
                    <span class="context-text" id="context-text">Context left until auto-compact: 100%</span>
                </div>
            </div>
        </div>

        <!-- Splitter: Middle <-> Right -->
        <div class="v-splitter" id="splitter-right" title="æ‹–æ‹½è°ƒæ•´å®½åº¦"></div>

        <!-- Preview Panel (Right) -->
        <div class="preview-panel" id="preview-panel">

            <!-- File Tabs -->
            <div class="file-tabs-container" id="file-tabs-container">
                <ul class="file-tabs" id="file-tabs">
                    <!-- æ–‡ä»¶æ ‡ç­¾åŠ¨æ€ç”Ÿæˆ -->
                </ul>
            </div>

            <!-- Inner Splitter: File list <-> Content -->
            <div class="v-splitter" id="splitter-preview" title="æ‹–æ‹½è°ƒæ•´æ–‡ä»¶åˆ—è¡¨å®½åº¦"></div>

            <!-- File Contents -->
            <div class="file-contents-container" id="file-contents-container">
                <div class="preview-content" id="preview-content">
                    <p class="preview-placeholder">Waiting for files...</p>
                </div>
            </div>
        </div>

    </div>

    <!-- Auth Modal -->
    <div class="auth-overlay" id="auth-overlay" style="display:none;">
        <div class="auth-modal">
            <div class="auth-title">Sign In</div>
            <div class="auth-field">
                <label>Username</label>
                <input type="text" id="auth-username" placeholder="Enter username" />
            </div>
            <div class="auth-field">
                <label>Password</label>
                <input type="password" id="auth-password" placeholder="Enter password" />
            </div>
            <div class="auth-error" id="auth-error"></div>
            <div class="auth-actions">
                <button id="auth-login-btn" class="primary">Sign In</button>
                <button id="auth-register-btn" class="secondary">Create Account</button>
            </div>
        </div>
    </div>

    <!-- Markdown Renderer -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <!-- SheetJS for Excel Preview -->
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>

    <!-- Scripts -->
    <script src="/static/js/sse.js?v=20251201-3"></script>
    <script src="/static/js/ui.js?v=20251201-3"></script>
    <script src="/static/js/app.js?v=20251201-3"></script>
</body>
</html>
